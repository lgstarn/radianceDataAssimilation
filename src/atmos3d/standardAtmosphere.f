module standardAtmosphere_mod
  implicit none

  integer, parameter :: TROPICAL_ATM = 1
  integer, parameter :: MID_LAT_SUMMER_ATM = 2
  integer, parameter :: MID_LAT_WINTER_ATM = 3
  integer, parameter :: SUB_ARCTIC_SUMMER_ATM = 4
  integer, parameter :: SUB_ARCTIC_WINTER_ATM = 5
  integer, parameter :: US_STANDARD_ATM = 6

  integer, parameter :: Z_INDEX = 1
  integer, parameter :: P_INDEX = 2
  integer, parameter :: T_INDEX = 3
  integer, parameter :: AIR_INDEX = 4
  integer, parameter :: O3_INDEX = 5
  integer, parameter :: O2_INDEX = 6
  integer, parameter :: H2O_INDEX = 7
  integer, parameter :: CO2_INDEX = 8
  integer, parameter :: NO2_INDEX = 9

  real(8), dimension(50*9), private :: tropicalatm=(/ &
  !#  AFGL atmospheric constituent profile. tropical. ( AFGL-TR-86-0110)
  !# z(km)     p(mb)        T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)      h2o(cm-3)     co2(cm-3)     no2(cm-3)
  120.000d0,   0.00002d0,  380.000d0, 4.288552d+11, 2.112500d+02, 3.063125d+10, 8.450001d+04, 1.478750d+07, 6.379750d+01, &
  115.000d0,   0.00004d0,  299.700d0, 8.700167d+11, 4.353000d+03, 8.183640d+10, 2.089440d+05, 3.482400d+07, 1.349430d+02, &
  110.000d0,   0.00006d0,  241.600d0, 1.939631d+12, 9.705000d+04, 2.329200d+11, 5.434800d+05, 1.164600d+08, 3.086190d+02, &
  105.000d0,   0.00013d0,  212.000d0, 4.441394d+12, 8.890001d+05, 6.223000d+11, 1.511300d+06, 4.889500d+08, 7.289800d+02, &
  100.000d0,   0.00029d0,  190.700d0, 1.097638d+13, 4.392000d+06, 1.756800d+12, 4.392000d+06, 2.141100d+09, 1.866600d+03, &
   95.000d0,   0.00069d0,  184.300d0, 2.703802d+13, 1.353000d+07, 4.870800d+12, 1.461240d+07, 7.306201d+09, 4.762560d+03, &
   90.000d0,   0.00172d0,  177.000d0, 7.038287d+13, 3.662360d+07, 1.338170d+13, 5.986550d+07, 2.183330d+10, 1.288869d+04, &
   85.000d0,   0.00440d0,  177.100d0, 1.799476d+14, 9.005000d+07, 3.602000d+13, 2.341300d+08, 5.763200d+10, 3.457920d+04, &
   80.000d0,   0.01100d0,  184.800d0, 4.311244d+14, 1.423620d+08, 9.016260d+13, 9.059399d+08, 1.414992d+11, 8.714280d+04, &
   75.000d0,   0.02600d0,  201.800d0, 9.331769d+14, 1.680840d+08, 1.951642d+14, 3.081540d+09, 3.081540d+11, 2.007670d+05, &
   70.000d0,   0.05800d0,  218.900d0, 1.919084d+15, 5.760000d+08, 4.012800d+14, 8.640000d+09, 6.336000d+11, 4.435200d+05, &
   65.000d0,   0.12100d0,  236.000d0, 3.713515d+15, 2.415400d+09, 7.766440d+14, 2.006640d+10, 1.226280d+12, 9.401481d+05, &
   60.000d0,   0.23900d0,  253.100d0, 6.839393d+15, 7.528400d+09, 1.430396d+15, 4.106400d+10, 2.258520d+12, 1.950540d+06, &
   55.000d0,   0.45600d0,  263.400d0, 1.253894d+16, 2.259000d+10, 2.622950d+15, 7.530000d+10, 4.141500d+12, 4.254450d+06, &
   50.000d0,   0.85400d0,  270.200d0, 2.289203d+16, 6.414800d+10, 4.788190d+15, 1.374600d+11, 7.560300d+12, 1.014913d+07, &
   47.500d0,   1.16000d0,  269.600d0, 3.116377d+16, 1.076055d+11, 6.518710d+15, 1.840210d+11, 1.029270d+13, 2.077254d+07, &
   45.000d0,   1.59000d0,  264.800d0, 4.349016d+16, 1.958400d+11, 9.095680d+15, 2.480640d+11, 1.436160d+13, 5.004800d+07, &
   42.500d0,   2.20000d0,  259.400d0, 6.142774d+16, 3.626730d+11, 1.284723d+16, 3.380850d+11, 2.028510d+13, 1.333899d+08, &
   40.000d0,   3.05000d0,  254.000d0, 8.697170d+16, 6.527249d+11, 1.818927d+16, 4.525560d+11, 2.871990d+13, 3.507309d+08, &
   37.500d0,   4.26000d0,  248.500d0, 1.241638d+17, 1.093840d+12, 2.597870d+16, 6.090700d+11, 4.101900d+13, 7.781180d+08, &
   35.000d0,   6.00000d0,  243.100d0, 1.787632d+17, 1.735330d+12, 3.739010d+16, 8.229400d+11, 5.903700d+13, 1.302392d+09, &
   32.500d0,   8.52000d0,  237.700d0, 2.596105d+17, 2.559030d+12, 5.429820d+16, 1.117140d+12, 8.573400d+13, 1.873158d+09, &
   30.000d0,   12.20000d0, 232.300d0, 3.803842d+17, 3.540510d+12, 7.956630d+16, 1.522800d+12, 1.256310d+14, 2.345112d+09, &
   27.500d0,   17.63000d0, 227.000d0, 5.625204d+17, 4.390620d+12, 1.176461d+17, 2.026440d+12, 1.857570d+14, 2.707549d+09, &
   25.000d0,   25.70000d0, 221.400d0, 8.407510d+17, 4.543020d+12, 1.758317d+17, 2.734225d+12, 2.776290d+14, 3.146462d+09, &
   24.000d0,   30.00000d0, 219.200d0, 9.912712d+17, 4.265600d+12, 2.073280d+17, 3.174400d+12, 3.273600d+14, 3.035520d+09, &
   23.000d0,   35.00000d0, 217.000d0, 1.168208d+18, 3.974600d+12, 2.443210d+17, 3.390100d+12, 3.857700d+14, 3.016020d+09, &
   22.000d0,   40.90000d0, 214.600d0, 1.380402d+18, 3.314400d+12, 2.886290d+17, 3.866800d+12, 4.557300d+14, 2.982960d+09, &
   21.000d0,   48.00000d0, 210.700d0, 1.650017d+18, 2.971800d+12, 3.450590d+17, 4.375150d+12, 5.448300d+14, 2.905760d+09, &
   20.000d0,   56.50000d0, 206.700d0, 1.979793d+18, 2.773400d+12, 4.140290d+17, 5.150600d+12, 6.537300d+14, 2.753590d+09, &
   19.000d0,   66.60000d0, 202.700d0, 2.379755d+18, 2.261950d+12, 4.976290d+17, 6.190600d+12, 7.857300d+14, 2.523860d+09, &
   18.000d0,   78.90000d0, 198.800d0, 2.874567d+18, 1.438500d+12, 6.012930d+17, 7.911750d+12, 9.494100d+14, 2.218167d+09, &
   17.000d0,   93.70000d0, 194.800d0, 3.483874d+18, 8.715000d+11, 7.285740d+17, 1.010940d+13, 1.150380d+15, 1.809234d+09, &
   16.000d0,  111.00000d0, 197.000d0, 4.081019d+18, 5.897296d+11, 8.535560d+17, 1.225200d+13, 1.347720d+15, 1.302796d+09, &
   15.000d0,  132.00000d0, 203.700d0, 4.693478d+18, 5.899431d+11, 9.816730d+17, 1.878800d+13, 1.550010d+15, 8.031870d+08, &
   14.000d0,  156.00000d0, 210.300d0, 5.372756d+18, 5.645850d+11, 1.123793d+18, 3.344494d+13, 1.774410d+15, 4.021996d+08, &
   13.000d0,  182.00000d0, 217.000d0, 6.074680d+18, 5.646784d+11, 1.270511d+18, 6.018210d+13, 2.006070d+15, 2.705155d+08, &
   12.000d0,  213.00000d0, 223.600d0, 6.899532d+18, 5.395476d+11, 1.442936d+18, 2.005612d+14, 2.278320d+15, 2.174760d+08, &
   11.000d0,  247.00000d0, 230.100d0, 7.774853d+18, 5.144914d+11, 1.626020d+18, 5.684068d+14, 2.567400d+15, 2.038360d+08, &
   10.000d0,  286.00000d0, 237.000d0, 8.740364d+18, 4.893947d+11, 1.828123d+18, 1.672426d+15, 2.886510d+15, 2.081786d+08, &
    9.000d0,  329.00000d0, 243.600d0, 9.782062d+18, 4.894500d+11, 2.045901d+18, 4.011532d+15, 3.230370d+15, 2.271048d+08, &
    8.000d0,  378.00000d0, 250.300d0, 1.093812d+19, 4.895745d+11, 2.288550d+18, 8.362515d+15, 3.613500d+15, 2.518500d+08, &
    7.000d0,  432.00000d0, 257.000d0, 1.217482d+19, 5.143614d+11, 2.545620d+18, 1.570002d+16, 4.019400d+15, 2.801400d+08, &
    6.000d0,  492.00000d0, 263.600d0, 1.351859d+19, 5.397117d+11, 2.827770d+18, 2.842653d+16, 4.464900d+15, 3.111900d+08, &
    5.000d0,  559.00000d0, 270.300d0, 1.497882d+19, 5.646733d+11, 3.132910d+18, 5.015654d+16, 4.946700d+15, 3.447700d+08, &
    4.000d0,  633.00000d0, 277.000d0, 1.655144d+19, 5.897016d+11, 3.461040d+18, 7.354296d+16, 5.464800d+15, 3.808800d+08, &
    3.000d0,  715.00000d0, 283.700d0, 1.825402d+19, 6.401807d+11, 3.818430d+18, 1.571220d+17, 6.029100d+15, 4.202100d+08, &
    2.000d0,  805.00000d0, 287.700d0, 2.026599d+19, 6.777576d+11, 4.238520d+18, 3.110952d+17, 6.692400d+15, 4.664400d+08, &
    1.000d0,  904.00000d0, 293.700d0, 2.229340d+19, 7.027649d+11, 4.662790d+18, 4.348219d+17, 7.362299d+15, 5.131300d+08, &
    0.000d0, 1013.00000d0, 299.700d0, 2.448130d+19, 7.029050d+11, 5.120500d+18, 6.352850d+17, 8.085000d+15, 5.635000d+08 /)

  real(8), dimension(50*9), private :: midlatsum=(/ &
  !#  AFGL atmospheric constituent profile. midlatitude summer. ( AFGL-TR-86-0110)
  !# z(km)      p(mb)       T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)      h2o(cm-3)     co2(cm-3)     no2(cm-3)
  120.000d0,    0.00002d0, 380.000d0, 4.326673d+11, 2.165000d+02, 3.139250d+10, 8.660000d+04, 1.515500d+07, 6.538300d+01, &
  115.000d0,    0.00004d0, 316.800d0, 8.139105d+11, 4.072500d+03, 7.656301d+10, 1.954800d+05, 3.258000d+07, 1.262475d+02, &
  110.000d0,    0.00006d0, 262.400d0, 1.686511d+12, 8.440001d+04, 2.025600d+11, 4.726400d+05, 1.012800d+08, 2.683920d+02, &
  105.000d0,    0.00012d0, 222.200d0, 3.813762d+12, 7.632000d+05, 5.342400d+11, 1.297440d+06, 4.197600d+08, 6.258240d+02, &
  100.000d0,    0.00026d0, 190.500d0, 9.809267d+12, 3.926400d+06, 1.570560d+12, 3.926400d+06, 1.914120d+09, 1.668720d+03, &
   95.000d0,    0.00062d0, 178.300d0, 2.538870d+13, 1.778700d+07, 4.573800d+12, 1.372140d+07, 6.860700d+09, 4.472160d+03, &
   90.000d0,    0.00164d0, 165.000d0, 7.198993d+13, 5.403000d+07, 1.368760d+13, 6.123400d+07, 2.233240d+10, 1.318332d+04, &
   85.000d0,    0.00448d0, 165.100d0, 1.965363d+14, 1.121190d+08, 3.934000d+13, 2.616110d+08, 6.294400d+10, 3.776640d+04, &
   80.000d0,    0.01200d0, 174.100d0, 4.992227d+14, 9.992000d+07, 1.044164d+14, 1.049160d+09, 1.638688d+11, 1.009192d+05, &
   75.000d0,    0.03000d0, 196.100d0, 1.108040d+15, 2.107100d+08, 2.317810d+14, 3.271550d+09, 3.659700d+11, 2.384350d+05, &
   70.000d0,    0.06700d0, 218.100d0, 2.225005d+15, 8.908001d+08, 4.654430d+14, 8.239900d+09, 7.349100d+11, 5.144370d+05, &
   65.000d0,    0.13900d0, 240.100d0, 4.193093d+15, 3.356800d+09, 8.769640d+14, 1.846240d+10, 1.384680d+12, 1.061588d+06, &
   60.000d0,    0.27200d0, 257.100d0, 7.662644d+15, 9.968400d+09, 1.602612d+15, 3.834000d+10, 2.530440d+12, 2.185380d+06, &
   55.000d0,    0.51500d0, 269.300d0, 1.385105d+16, 2.494800d+10, 2.896740d+15, 7.415099d+10, 4.573800d+12, 4.698540d+06, &
   50.000d0,    0.95100d0, 275.700d0, 2.498363d+16, 7.000000d+10, 5.225000d+15, 1.375000d+11, 8.250000d+12, 1.107500d+07, &
   47.500d0,    1.29000d0, 275.200d0, 3.395104d+16, 1.189300d+11, 7.101820d+15, 1.868900d+11, 1.121340d+13, 2.263068d+07, &
   45.000d0,    1.76000d0, 269.900d0, 4.723040d+16, 2.126700d+11, 9.877339d+15, 2.575670d+11, 1.559580d+13, 5.434900d+07, &
   42.500d0,    2.41000d0, 263.700d0, 6.619401d+16, 3.908160d+11, 1.384416d+16, 3.510720d+11, 2.185920d+13, 1.437408d+08, &
   40.000d0,    3.33000d0, 257.500d0, 9.366532d+16, 7.076615d+11, 1.958957d+16, 4.780230d+11, 3.093090d+13, 3.777319d+08, &
   37.500d0,    4.64000d0, 251.300d0, 1.337326d+17, 1.164060d+12, 2.796420d+16, 6.690000d+11, 4.415400d+13, 8.375880d+08, &
   35.000d0,    6.52000d0, 245.200d0, 1.925923d+17, 1.715030d+12, 4.027430d+16, 9.538649d+11, 6.359100d+13, 1.402856d+09, &
   32.500d0,    9.30000d0, 239.000d0, 2.818363d+17, 2.284200d+12, 5.893800d+16, 1.367700d+12, 9.306000d+13, 2.033220d+09, &
   30.000d0,   13.20000d0, 233.700d0, 4.090977d+17, 2.865800d+12, 8.556460d+16, 1.924180d+12, 1.351020d+14, 2.521904d+09, &
   27.500d0,   19.07000d0, 228.450d0, 6.046045d+17, 3.630000d+12, 1.264450d+17, 2.692250d+12, 1.996500d+14, 2.910050d+09, &
   25.000d0,   27.70000d0, 225.100d0, 8.912839d+17, 4.281120d+12, 1.864071d+17, 3.745980d+12, 2.943270d+14, 3.335706d+09, &
   24.000d0,   32.20000d0, 223.900d0, 1.041630d+18, 4.168000d+12, 2.177780d+17, 4.168000d+12, 3.438600d+14, 3.188520d+09, &
   23.000d0,   37.60000d0, 222.800d0, 1.222319d+18, 4.158200d+12, 2.556070d+17, 4.708550d+12, 4.035900d+14, 3.155340d+09, &
   22.000d0,   43.70000d0, 221.600d0, 1.428313d+18, 4.144100d+12, 2.986610d+17, 5.144399d+12, 4.715700d+14, 3.086640d+09, &
   21.000d0,   51.00000d0, 220.400d0, 1.675986d+18, 4.024800d+12, 3.504930d+17, 5.785650d+12, 5.534100d+14, 2.951520d+09, &
   20.000d0,   59.50000d0, 219.200d0, 1.966021d+18, 3.934000d+12, 4.111030d+17, 6.491100d+12, 6.491100d+14, 2.734130d+09, &
   19.000d0,   69.50000d0, 217.900d0, 2.310146d+18, 3.468000d+12, 4.832080d+17, 7.398400d+12, 7.629600d+14, 2.450720d+09, &
   18.000d0,   81.20000d0, 216.800d0, 2.712742d+18, 2.715000d+12, 5.674350d+17, 8.552250d+12, 8.959500d+14, 2.093265d+09, &
   17.000d0,   95.00000d0, 215.700d0, 3.189961d+18, 2.234400d+12, 6.671280d+17, 1.021440d+13, 1.053360d+15, 1.656648d+09, &
   16.000d0,  111.00000d0, 215.700d0, 3.727217d+18, 2.238000d+12, 7.795700d+17, 1.230900d+13, 1.230900d+15, 1.189870d+09, &
   15.000d0,  130.00000d0, 215.700d0, 4.365209d+18, 2.184000d+12, 9.129120d+17, 1.485120d+13, 1.441440d+15, 7.469280d+08, &
   14.000d0,  153.00000d0, 215.700d0, 5.137515d+18, 2.262040d+12, 1.074469d+18, 2.570500d+13, 1.696530d+15, 3.845468d+08, &
   13.000d0,  179.00000d0, 215.800d0, 6.007772d+18, 1.803600d+12, 1.256508d+18, 4.809600d+13, 1.983960d+15, 2.675340d+08, &
   12.000d0,  209.00000d0, 222.300d0, 6.809554d+18, 1.519522d+12, 1.424126d+18, 2.006042d+14, 2.248620d+15, 2.146410d+08, &
   11.000d0,  243.00000d0, 228.800d0, 7.692404d+18, 1.380251d+12, 1.608882d+18, 7.356209d+14, 2.540340d+15, 2.016876d+08, &
   10.000d0,  281.00000d0, 235.300d0, 8.649604d+18, 1.128742d+12, 1.809104d+18, 2.139763d+15, 2.856480d+15, 2.060128d+08, &
    9.000d0,  324.00000d0, 241.700d0, 9.709126d+18, 1.079448d+12, 2.030644d+18, 4.011736d+15, 3.206280d+15, 2.254112d+08, &
    8.000d0,  372.00000d0, 248.200d0, 1.085558d+19, 9.910836d+11, 2.269740d+18, 7.019904d+15, 3.583800d+15, 2.497800d+08, &
    7.000d0,  426.00000d0, 254.700d0, 1.211414d+19, 9.409968d+11, 2.533080d+18, 1.236240d+16, 3.999600d+15, 2.787600d+08, &
    6.000d0,  487.00000d0, 261.200d0, 1.350416d+19, 8.657207d+11, 2.823590d+18, 2.040010d+16, 4.458300d+15, 3.107300d+08, &
    5.000d0,  554.00000d0, 267.200d0, 1.501707d+19, 8.284536d+11, 3.141270d+18, 3.344175d+16, 4.959900d+15, 3.456900d+08, &
    4.000d0,  628.00000d0, 273.200d0, 1.664910d+19, 8.031786d+11, 3.481940d+18, 6.352458d+16, 5.497800d+15, 3.831800d+08, &
    3.000d0,  710.00000d0, 279.200d0, 1.841852d+19, 7.781146d+11, 3.851870d+18, 1.102851d+17, 6.081900d+15, 4.238900d+08, &
    2.000d0,  802.00000d0, 285.200d0, 2.036745d+19, 7.528372d+11, 4.259420d+18, 1.972784d+17, 6.725400d+15, 4.687400d+08, &
    1.000d0,  902.00000d0, 289.700d0, 2.255121d+19, 7.531609d+11, 4.717130d+18, 3.110146d+17, 7.448100d+15, 5.191100d+08, &
    0.000d0, 1013.00000d0, 294.200d0, 2.493898d+19, 7.530432d+11, 5.216640d+18, 4.682496d+17, 8.236800d+15, 5.740800d+08 /)

  real(8), dimension(50*9), private :: midlatwin=(/ &
  !# AFGL atmospheric constituent profile. midlatitude winter. ( AFGL-TR-86-0110)
  !# z(km)      p(mb)       T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)      h2o(cm-3)     co2(cm-3)    no2(cm-3)
  120.000d0,    0.00004d0, 333.000d0, 7.830151d+11, 3.918000d+02, 5.681100d+10, 1.567200d+05, 2.742600d+07, 1.183236d+02, &
  115.000d0,    0.00006d0, 293.000d0, 1.478242d+12, 7.395000d+03, 1.390260d+11, 3.549600d+05, 5.916000d+07, 2.292450d+02, &
  110.000d0,    0.00011d0, 259.500d0, 2.950186d+12, 1.476000d+05, 3.542400d+11, 8.265599d+05, 1.771200d+08, 4.693680d+02, &
  105.000d0,    0.00020d0, 237.100d0, 6.109564d+12, 1.222800d+06, 8.559601d+11, 2.078760d+06, 6.725400d+08, 1.002696d+03, &
  100.000d0,    0.00041d0, 218.600d0, 1.349841d+13, 5.404000d+06, 2.161600d+12, 5.404000d+06, 2.634450d+09, 2.296700d+03, &
   95.000d0,    0.00088d0, 208.300d0, 3.049454d+13, 2.441600d+07, 5.493600d+12, 1.648080d+07, 8.240400d+09, 5.371520d+03, &
   90.000d0,    0.00198d0, 199.500d0, 7.188431d+13, 5.755200d+07, 1.366860d+13, 6.114900d+07, 2.230140d+10, 1.316502d+04, &
   85.000d0,    0.00456d0, 199.800d0, 1.653032d+14, 9.097000d+07, 3.308000d+13, 2.199820d+08, 5.292800d+10, 3.175680d+04, &
   80.000d0,    0.01030d0, 210.100d0, 3.550774d+14, 8.171900d+07, 7.425770d+13, 7.106000d+08, 1.165384d+11, 7.177059d+04, &
   75.000d0,    0.02220d0, 220.400d0, 7.295469d+14, 1.825250d+08, 1.525909d+14, 1.971270d+09, 2.409330d+11, 1.569715d+05, &
   70.000d0,    0.04700d0, 230.700d0, 1.475577d+15, 4.726400d+08, 3.086930d+14, 4.874100d+09, 4.874100d+11, 3.411870d+05, &
   65.000d0,    0.09500d0, 240.900d0, 2.856266d+15, 1.571900d+09, 5.973220d+14, 1.143200d+10, 9.431400d+11, 7.230740d+05, &
   60.000d0,    0.18800d0, 250.800d0, 5.429278d+15, 5.433000d+09, 1.135497d+15, 2.444850d+10, 1.792890d+12, 1.548405d+06, &
   55.000d0,    0.36200d0, 260.600d0, 1.006111d+16, 1.711900d+10, 2.104630d+15, 4.883950d+10, 3.323100d+12, 3.413730d+06, &
   50.000d0,    0.68300d0, 265.700d0, 1.861834d+16, 5.123250d+10, 3.893670d+15, 9.221850d+10, 6.147900d+12, 8.253090d+06, &
   47.500d0,    0.94000d0, 265.100d0, 2.568206d+16, 9.509000d+10, 5.371300d+15, 1.285000d+11, 8.481000d+12, 1.711620d+07, &
   45.000d0,    1.29000d0, 258.500d0, 3.614440d+16, 1.663820d+11, 7.559530d+15, 1.808500d+11, 1.193610d+13, 4.159550d+07, &
   42.500d0,    1.80000d0, 250.800d0, 5.198245d+16, 3.069180d+11, 1.087218d+16, 2.601000d+11, 1.716660d+13, 1.128834d+08, &
   40.000d0,    2.53000d0, 243.200d0, 7.534749d+16, 5.202600d+11, 1.575860d+16, 3.732300d+11, 2.488200d+13, 3.038620d+08, &
   37.500d0,    3.60000d0, 235.500d0, 1.107193d+17, 7.977600d+11, 2.315720d+16, 5.429200d+11, 3.656400d+13, 6.936080d+08, &
   35.000d0,    5.18000d0, 227.900d0, 1.646256d+17, 1.169370d+12, 3.442230d+16, 7.987950d+11, 5.435100d+13, 1.199016d+09, &
   32.500d0,    7.56000d0, 220.400d0, 2.484403d+17, 1.690480d+12, 5.195740d+16, 1.193280d+12, 8.203800d+13, 1.792406d+09, &
   30.000d0,   11.10000d0, 217.400d0, 3.698071d+17, 2.257610d+12, 7.735090d+16, 1.757975d+12, 1.221330d+14, 2.279816d+09, &
   27.500d0,   16.46000d0, 215.500d0, 5.532155d+17, 3.100160d+12, 1.157024d+17, 2.601920d+12, 1.826880d+14, 2.662816d+09, &
   25.000d0,   24.40000d0, 215.200d0, 8.212197d+17, 4.191180d+12, 1.717562d+17, 3.821370d+12, 2.711940d+14, 3.073532d+09, &
   24.000d0,   28.60000d0, 215.200d0, 9.625772d+17, 4.527510d+12, 2.013297d+17, 4.431180d+12, 3.178890d+14, 2.947698d+09, &
   23.000d0,   33.40000d0, 215.200d0, 1.124129d+18, 4.837501d+12, 2.351250d+17, 5.118751d+12, 3.712500d+14, 2.902500d+09, &
   22.000d0,   39.10000d0, 215.200d0, 1.315971d+18, 5.136300d+12, 2.752530d+17, 5.966010d+12, 4.346100d+14, 2.844720d+09, &
   21.000d0,   45.80000d0, 215.200d0, 1.541470d+18, 5.400500d+12, 3.224870d+17, 6.943500d+12, 5.091900d+14, 2.715680d+09, &
   20.000d0,   53.70000d0, 215.200d0, 1.807356d+18, 5.246100d+12, 3.780810d+17, 8.140500d+12, 5.969700d+14, 2.514510d+09, &
   19.000d0,   62.80000d0, 215.200d0, 2.113631d+18, 4.864500d+12, 4.420350d+17, 9.517500d+12, 6.979500d+14, 2.241900d+09, &
   18.000d0,   73.60000d0, 215.700d0, 2.471380d+18, 4.451400d+12, 5.168570d+17, 1.112850d+13, 8.160900d+14, 1.906683d+09, &
   17.000d0,   86.10000d0, 216.200d0, 2.884426d+18, 4.040400d+12, 6.031740d+17, 1.298700d+13, 9.523800d+14, 1.497834d+09, &
   16.000d0,  100.70000d0, 216.700d0, 3.365754d+18, 3.704800d+12, 7.039120d+17, 1.549280d+13, 1.111440d+15, 1.074392d+09, &
   15.000d0,  117.80000d0, 217.200d0, 3.928234d+18, 3.537900d+12, 8.215790d+17, 1.847570d+13, 1.297230d+15, 6.722010d+08, &
   14.000d0,  137.80000d0, 217.700d0, 4.584612d+18, 3.670400d+12, 9.588920d+17, 2.202240d+13, 1.514040d+15, 3.431824d+08, &
   13.000d0,  161.10001d0, 218.200d0, 5.347523d+18, 3.764963d+12, 1.118359d+18, 2.675500d+13, 1.765830d+15, 2.381195d+08, &
   12.000d0,  188.20000d0, 218.700d0, 6.232793d+18, 3.263198d+12, 1.303533d+18, 3.742200d+13, 2.058210d+15, 1.964655d+08, &
   11.000d0,  219.89999d0, 219.200d0, 7.266018d+18, 2.635010d+12, 1.519639d+18, 7.271000d+13, 2.399430d+15, 1.905002d+08, &
   10.000d0,  256.79999d0, 219.700d0, 8.465970d+18, 2.007864d+12, 1.770648d+18, 2.507712d+14, 2.795760d+15, 2.016336d+08, &
    9.000d0,  299.29999d0, 225.700d0, 9.604770d+18, 1.506200d+12, 2.008908d+18, 5.350039d+14, 3.171960d+15, 2.229984d+08, &
    8.000d0,  347.29999d0, 231.700d0, 1.085652d+19, 1.128354d+12, 2.269740d+18, 1.169622d+15, 3.583800d+15, 2.497800d+08, &
    7.000d0,  401.60001d0, 237.700d0, 1.223704d+19, 9.666475d+11, 2.560250d+18, 2.843225d+15, 4.042500d+15, 2.817500d+08, &
    6.000d0,  462.70001d0, 243.700d0, 1.375168d+19, 8.031712d+11, 2.875840d+18, 7.021728d+15, 4.540800d+15, 3.164800d+08, &
    5.000d0,  531.29999d0, 249.700d0, 1.541108d+19, 7.278240d+11, 3.222780d+18, 1.270762d+16, 5.088600d+15, 3.546600d+08, &
    4.000d0,  608.09998d0, 255.700d0, 1.722488d+19, 6.149508d+11, 3.603160d+18, 2.206720d+16, 5.689200d+15, 3.965200d+08, &
    3.000d0,  693.79999d0, 261.700d0, 1.920182d+19, 6.150400d+11, 4.016980d+18, 4.013136d+16, 6.342600d+15, 4.420600d+08, &
    2.000d0,  789.70001d0, 265.200d0, 2.156753d+19, 6.148142d+11, 4.510220d+18, 6.016504d+16, 7.121400d+15, 4.963400d+08, &
    1.000d0,  897.29999d0, 268.700d0, 2.418699d+19, 6.776000d+11, 5.057800d+18, 8.358680d+16, 7.986000d+15, 5.566000d+08, &
    0.000d0, 1018.00000d0, 272.200d0, 2.708766d+19, 7.531159d+11, 5.665990d+18, 1.170068d+17, 8.946300d+15, 6.235300d+08 /)

    real(8), dimension(50*9), private :: subarcsum=(/ &
    !# AFGL atmospheric constituent profile. subarctic summer. ( AFGL-TR-86-0110)
    !# z(km)      p(mb)         T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)      h2o(cm-3)     co2(cm-3)      no2(cm-3)
    120.000d0,    0.00002d0, 380.000d0, 4.307612d+11, 2.155500d+02, 3.125475d+10, 8.622001d+04, 1.508850d+07, 6.509610d+01, &
    115.000d0,    0.00004d0, 322.700d0, 7.945406d+11, 3.975500d+03, 7.473940d+10, 1.908240d+05, 3.180400d+07, 1.232405d+02, &
    110.000d0,    0.00006d0, 270.100d0, 1.608935d+12, 8.050000d+04, 1.932000d+11, 4.508000d+05, 9.660000d+07, 2.559900d+02, &
    105.000d0,    0.00011d0, 226.000d0, 3.621444d+12, 7.248001d+05, 5.073600d+11, 1.232160d+06, 3.986400d+08, 5.943360d+02, &
    100.000d0,    0.00025d0, 190.400d0, 9.434015d+12, 3.776400d+06, 1.510560d+12, 3.776400d+06, 1.840995d+09, 1.604970d+03, &
     95.000d0,    0.00061d0, 176.800d0, 2.482574d+13, 1.987200d+07, 4.471200d+12, 1.341360d+07, 6.706800d+09, 4.371840d+03, &
     90.000d0,    0.00161d0, 161.600d0, 7.215997d+13, 6.498900d+07, 1.371990d+13, 6.137850d+07, 2.238510d+10, 1.321443d+04, &
     85.000d0,    0.00451d0, 161.700d0, 2.020125d+14, 1.314300d+08, 4.044000d+13, 2.689260d+08, 6.470400d+10, 3.882240d+04, &
     80.000d0,    0.01250d0, 170.600d0, 5.306923d+14, 9.559800d+07, 1.109999d+14, 1.062200d+09, 1.742008d+11, 1.072822d+05, &
     75.000d0,    0.03200d0, 193.600d0, 1.197172d+15, 2.396000d+08, 2.503820d+14, 3.234600d+09, 3.953400d+11, 2.575700d+05, &
     70.000d0,    0.07100d0, 216.600d0, 2.374169d+15, 9.504000d+08, 4.965840d+14, 7.840800d+09, 7.840800d+11, 5.488560d+05, &
     65.000d0,    0.14700d0, 239.700d0, 4.441822d+15, 3.556000d+09, 9.290050d+14, 1.778000d+10, 1.466850d+12, 1.124585d+06, &
     60.000d0,    0.28800d0, 262.700d0, 7.940434d+15, 9.535200d+09, 1.660714d+15, 3.575700d+10, 2.622180d+12, 2.264610d+06, &
     55.000d0,    0.53700d0, 274.000d0, 1.419501d+16, 2.415700d+10, 2.969890d+15, 6.891850d+10, 4.689300d+12, 4.817190d+06, &
     50.000d0,    0.98700d0, 277.200d0, 2.578907d+16, 6.452500d+10, 5.394290d+15, 1.277595d+11, 8.517300d+12, 1.143383d+07, &
     47.500d0,    1.34000d0, 276.200d0, 3.513929d+16, 1.125120d+11, 7.348440d+15, 1.758000d+11, 1.160280d+13, 2.341656d+07, &
     45.000d0,    1.82000d0, 273.600d0, 4.818004d+16, 2.024820d+11, 1.007589d+16, 2.410500d+11, 1.590930d+13, 5.544150d+07, &
     42.500d0,    2.48000d0, 269.500d0, 6.665071d+16, 3.601800d+11, 1.394030d+16, 3.335000d+11, 2.201100d+13, 1.447390d+08, &
     40.000d0,    3.40000d0, 262.100d0, 9.395583d+16, 6.581400d+11, 1.965018d+16, 4.701000d+11, 3.102660d+13, 3.789006d+08, &
     37.500d0,    4.72000d0, 254.600d0, 1.342751d+17, 1.048320d+12, 2.808960d+16, 6.720000d+11, 4.435200d+13, 8.413440d+08, &
     35.000d0,    6.61000d0, 247.200d0, 1.936711d+17, 1.492260d+12, 4.050420d+16, 9.690000d+11, 6.395400d+13, 1.410864d+09, &
     32.500d0,    9.40000d0, 240.000d0, 2.836798d+17, 1.958910d+12, 5.933510d+16, 1.419500d+12, 9.368700d+13, 2.046919d+09, &
     30.000d0,   13.40000d0, 235.100d0, 4.128230d+17, 2.354670d+12, 8.633790d+16, 2.065500d+12, 1.363230d+14, 2.544696d+09, &
     27.500d0,   19.23000d0, 231.000d0, 6.029470d+17, 3.198020d+12, 1.261106d+17, 2.986830d+12, 1.991220d+14, 2.902354d+09, &
     25.000d0,   27.80000d0, 228.100d0, 8.827370d+17, 3.975300d+12, 1.846306d+17, 4.328660d+12, 2.915220d+14, 3.303916d+09, &
     24.000d0,   32.28000d0, 226.600d0, 1.031776d+18, 4.338600d+12, 2.158970d+17, 5.010049d+12, 3.408900d+14, 3.160980d+09, &
     23.000d0,   37.50000d0, 225.200d0, 1.206076d+18, 4.465900d+12, 2.522630d+17, 5.829810d+12, 3.983100d+14, 3.114060d+09, &
     22.000d0,   43.60000d0, 225.200d0, 1.402264d+18, 4.629900d+12, 2.932270d+17, 6.734400d+12, 4.629900d+14, 3.030480d+09, &
     21.000d0,   50.70000d0, 225.200d0, 1.630615d+18, 4.406400d+12, 3.410880d+17, 7.670400d+12, 5.385600d+14, 2.872320d+09, &
     20.000d0,   59.00000d0, 225.200d0, 1.897560d+18, 3.987900d+12, 3.968910d+17, 8.735400d+12, 6.266700d+14, 2.639610d+09, &
     19.000d0,   68.60000d0, 225.200d0, 2.206315d+18, 3.753600d+12, 4.614720d+17, 9.936000d+12, 7.286400d+14, 2.340480d+09, &
     18.000d0,   79.80000d0, 225.200d0, 2.566530d+18, 3.338400d+12, 5.367120d+17, 1.104240d+13, 8.474400d+14, 1.979928d+09, &
     17.000d0,   92.80000d0, 225.200d0, 2.984637d+18, 2.987000d+12, 6.242830d+17, 1.209735d+13, 9.857100d+14, 1.550253d+09, &
     16.000d0,  108.00000d0, 225.200d0, 3.473499d+18, 2.954600d+12, 7.264840d+17, 1.390400d+13, 1.147080d+15, 1.108844d+09, &
     15.000d0,  126.00000d0, 225.200d0, 4.052416d+18, 2.838500d+12, 8.474950d+17, 1.622000d+13, 1.338150d+15, 6.934050d+08, &
     14.000d0,  146.00000d0, 225.200d0, 4.695657d+18, 2.819400d+12, 9.820909d+17, 1.879600d+13, 1.550670d+15, 3.514852d+08, &
     13.000d0,  170.00000d0, 225.200d0, 5.467545d+18, 2.735500d+12, 1.143439d+18, 2.434595d+13, 1.805430d+15, 2.434595d+08, &
     12.000d0,  197.70000d0, 225.200d0, 6.358433d+18, 2.608830d+12, 1.329867d+18, 3.817800d+13, 2.099790d+15, 2.004345d+08, &
     11.000d0,  230.00000d0, 225.200d0, 7.397267d+18, 2.257610d+12, 1.547018d+18, 9.844661d+13, 2.442660d+15, 1.939324d+08, &
     10.000d0,  267.70001d0, 225.200d0, 8.609776d+18, 1.628424d+12, 1.800744d+18, 3.653184d+14, 2.843280d+15, 2.050608d+08, &
      9.000d0,  310.79999d0, 232.200d0, 9.694616d+18, 1.377542d+12, 2.027509d+18, 1.261130d+15, 3.201330d+15, 2.250632d+08, &
      8.000d0,  359.00000d0, 239.200d0, 1.087039d+19, 9.916032d+11, 2.273920d+18, 4.347648d+15, 3.590400d+15, 2.502400d+08, &
      7.000d0,  413.00000d0, 246.100d0, 1.215487d+19, 9.409409d+11, 2.541440d+18, 9.692736d+15, 4.012800d+15, 2.796800d+08, &
      6.000d0,  474.00000d0, 253.100d0, 1.356432d+19, 8.907348d+11, 2.836130d+18, 1.804810d+16, 4.478100d+15, 3.121100d+08, &
      5.000d0,  541.00000d0, 260.100d0, 1.506498d+19, 8.034624d+11, 3.151720d+18, 3.344744d+16, 4.976400d+15, 3.468400d+08, &
      4.000d0,  616.00000d0, 265.500d0, 1.680459d+19, 7.531996d+11, 3.515380d+18, 5.685160d+16, 5.550600d+15, 3.868600d+08, &
      3.000d0,  700.00000d0, 270.900d0, 1.871548d+19, 7.280351d+11, 3.914570d+18, 9.027860d+16, 6.180900d+15, 4.307900d+08, &
      2.000d0,  792.90002d0, 276.300d0, 2.078497d+19, 7.028321d+11, 4.347200d+18, 1.404000d+17, 6.864000d+15, 4.784000d+08, &
      1.000d0,  896.00000d0, 281.700d0, 2.303737d+19, 6.776700d+11, 4.817450d+18, 2.005581d+17, 7.606500d+15, 5.301500d+08, &
      0.000d0, 1010.00000d0, 287.200d0, 2.547116d+19, 6.148188d+11, 5.327410d+18, 3.043506d+17, 8.411700d+15, 5.862700d+08 /)

  real(8), dimension(50*9), private :: subarcwin=(/ &
  !# AFGL atmospheric constituent profile. subarctic winter. ( AFGL-TR-86-0110)
  !# z(km)      p(mb)       T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)      h2o(cm-3)     co2(cm-3)     no2(cm-3)
  120.000d0,    0.00004d0, 333.000d0, 7.808399d+11, 3.907000d+02, 5.665150d+10, 1.562800d+05, 2.734900d+07, 1.179914d+02, &
  115.000d0,    0.00006d0, 288.500d0, 1.506320d+12, 7.535000d+03, 1.416580d+11, 3.616800d+05, 6.028000d+07, 2.335850d+02, &
  110.000d0,    0.00011d0, 252.600d0, 3.096722d+12, 1.549500d+05, 3.718800d+11, 8.677201d+05, 1.859400d+08, 4.927410d+02, &
  105.000d0,    0.00021d0, 234.000d0, 6.407171d+12, 1.282400d+06, 8.976799d+11, 2.180080d+06, 7.053200d+08, 1.051568d+03, &
  100.000d0,    0.00042d0, 218.500d0, 1.402170d+13, 5.612000d+06, 2.244800d+12, 5.612000d+06, 2.735850d+09, 2.385100d+03, &
   95.000d0,    0.00091d0, 211.000d0, 3.113413d+13, 2.492800d+07, 5.608800d+12, 1.682640d+07, 8.413200d+09, 5.484160d+03, &
   90.000d0,    0.00202d0, 202.300d0, 7.239309d+13, 5.795200d+07, 1.376360d+13, 6.157400d+07, 2.245640d+10, 1.325652d+04, &
   85.000d0,    0.00450d0, 213.100d0, 1.529470d+14, 1.148250d+08, 3.062000d+13, 2.036230d+08, 4.899200d+10, 2.939520d+04, &
   80.000d0,    0.00966d0, 223.900d0, 3.124891d+14, 4.065100d+07, 6.535430d+13, 6.254000d+08, 1.025656d+11, 6.316540d+04, &
   75.000d0,    0.02000d0, 234.700d0, 6.172040d+14, 2.038080d+08, 1.290784d+14, 1.667520d+09, 2.038080d+11, 1.327840d+05, &
   70.000d0,    0.04000d0, 245.400d0, 1.180585d+15, 5.905000d+08, 2.468290d+14, 3.897300d+09, 3.897300d+11, 2.728110d+05, &
   65.000d0,    0.07900d0, 248.400d0, 2.303495d+15, 1.498250d+09, 4.817450d+14, 9.220000d+09, 7.606500d+11, 5.831650d+05, &
   60.000d0,    0.15500d0, 250.900d0, 4.474483d+15, 4.254100d+09, 9.359020d+14, 2.015100d+10, 1.477740d+12, 1.276230d+06, &
   55.000d0,    0.29900d0, 259.100d0, 8.358255d+15, 1.338240d+10, 1.748076d+15, 4.056540d+10, 2.760120d+12, 2.835396d+06, &
   50.000d0,    0.57190d0, 259.300d0, 1.597458d+16, 4.157400d+10, 3.341910d+15, 7.915050d+10, 5.276700d+12, 7.083570d+06, &
   47.500d0,    0.79000d0, 253.200d0, 2.259827d+16, 6.783000d+10, 4.725491d+15, 1.130500d+11, 7.461300d+12, 1.505826d+07, &
   45.000d0,    1.11300d0, 247.000d0, 3.263698d+16, 1.339060d+11, 6.825940d+15, 1.633000d+11, 1.077780d+13, 3.755900d+07, &
   42.500d0,    1.57000d0, 240.800d0, 4.722316d+16, 2.410260d+11, 9.877339d+15, 2.363000d+11, 1.559580d+13, 1.025542d+08, &
   40.000d0,    2.24300d0, 234.700d0, 6.921943d+16, 4.086930d+11, 1.447743d+16, 3.463500d+11, 2.285910d+13, 2.791581d+08, &
   37.500d0,    3.23000d0, 228.500d0, 1.023831d+17, 6.406250d+11, 2.142250d+16, 5.125000d+11, 3.382500d+13, 6.416500d+08, &
   35.000d0,    4.70100d0, 222.300d0, 1.531661d+17, 9.504599d+11, 3.203970d+16, 7.664999d+11, 5.058900d+13, 1.116024d+09, &
   32.500d0,    6.91000d0, 218.500d0, 2.290543d+17, 1.352280d+12, 4.790280d+16, 1.146000d+12, 7.563600d+13, 1.652532d+09, &
   30.000d0,   10.20000d0, 216.000d0, 3.420253d+17, 1.848420d+12, 7.154070d+16, 1.711500d+12, 1.129590d+14, 2.108568d+09, &
   27.500d0,   15.13000d0, 213.600d0, 5.130379d+17, 2.515660d+12, 1.073006d+17, 2.567000d+12, 1.694220d+14, 2.469454d+09, &
   25.000d0,   22.56000d0, 211.200d0, 7.736723d+17, 3.638740d+12, 1.618078d+17, 3.871000d+12, 2.554860d+14, 2.895508d+09, &
   24.000d0,   26.49000d0, 211.800d0, 9.058741d+17, 4.169900d+12, 1.894585d+17, 4.532500d+12, 2.991450d+14, 2.773890d+09, &
   23.000d0,   31.09000d0, 212.400d0, 1.060176d+18, 4.774500d+12, 2.217490d+17, 5.251950d+12, 3.501300d+14, 2.737380d+09, &
   22.000d0,   36.47000d0, 213.000d0, 1.240132d+18, 5.212200d+12, 2.593690d+17, 6.080900d+12, 4.095300d+14, 2.680560d+09, &
   21.000d0,   42.77000d0, 213.600d0, 1.450273d+18, 5.804000d+12, 3.032590d+17, 7.037350d+12, 4.788300d+14, 2.553760d+09, &
   20.000d0,   50.14000d0, 214.200d0, 1.695418d+18, 6.278900d+12, 3.546730d+17, 8.145601d+12, 5.600100d+14, 2.358830d+09, &
   19.000d0,   58.75000d0, 214.800d0, 1.981004d+18, 6.144200d+12, 4.142380d+17, 9.414500d+12, 6.540600d+14, 2.100920d+09, &
   18.000d0,   68.82000d0, 215.400d0, 2.314093d+18, 5.674200d+12, 4.840440d+17, 1.088520d+13, 7.642800d+14, 1.785636d+09, &
   17.000d0,   80.58000d0, 216.000d0, 2.702000d+18, 5.137600d+12, 5.651360d+17, 1.257360d+13, 8.923200d+14, 1.403376d+09, &
   16.000d0,   94.31000d0, 216.600d0, 3.153632d+18, 4.734000d+12, 6.596040d+17, 1.451760d+13, 1.041480d+15, 1.006764d+09, &
   15.000d0,  110.30000d0, 217.200d0, 3.678134d+18, 4.417200d+12, 7.693290d+17, 1.674855d+13, 1.214730d+15, 6.294510d+08, &
   14.000d0,  129.10001d0, 217.200d0, 4.305051d+18, 3.877200d+12, 9.003720d+17, 1.938600d+13, 1.421640d+15, 3.222384d+08, &
   13.000d0,  151.00000d0, 217.200d0, 5.035342d+18, 3.275350d+12, 1.053151d+18, 2.242355d+13, 1.662870d+15, 2.242355d+08, &
   12.000d0,  176.60001d0, 217.200d0, 5.889016d+18, 2.357200d+12, 1.231637d+18, 3.535800d+13, 1.944690d+15, 1.856295d+08, &
   11.000d0,  206.70000d0, 217.200d0, 6.892749d+18, 2.414300d+12, 1.441682d+18, 6.898000d+13, 2.276340d+15, 1.807276d+08, &
   10.000d0,  241.80000d0, 217.200d0, 8.063216d+18, 2.420700d+12, 1.686421d+18, 1.613800d+14, 2.662770d+15, 1.920422d+08, &
    9.000d0,  282.89999d0, 217.200d0, 9.433762d+18, 1.982400d+12, 1.972960d+18, 2.809344d+14, 3.115200d+15, 2.190080d+08, &
    8.000d0,  330.79999d0, 220.600d0, 1.086105d+19, 1.130480d+12, 2.271830d+18, 3.678408d+14, 3.587100d+15, 2.500100d+08, &
    7.000d0,  385.29999d0, 227.300d0, 1.227754d+19, 8.912709d+11, 2.568610d+18, 1.806630d+15, 4.055700d+15, 2.826700d+08, &
    6.000d0,  446.70001d0, 234.100d0, 1.382058d+19, 6.148818d+11, 2.890470d+18, 3.276327d+15, 4.563900d+15, 3.180900d+08, &
    5.000d0,  515.79999d0, 240.900d0, 1.550802d+19, 5.899152d+11, 3.243680d+18, 6.687568d+15, 5.121600d+15, 3.569600d+08, &
    4.000d0,  593.20001d0, 247.700d0, 1.734551d+19, 5.647208d+11, 3.628240d+18, 1.371093d+16, 5.728800d+15, 3.992800d+08, &
    3.000d0,  679.79999d0, 252.700d0, 1.948443d+19, 5.395650d+11, 4.075500d+18, 2.273700d+16, 6.435000d+15, 4.485000d+08, &
    2.000d0,  777.50000d0, 255.900d0, 2.200604d+19, 5.143872d+11, 4.602180d+18, 3.142254d+16, 7.266600d+15, 5.064600d+08, &
    1.000d0,  887.79999d0, 259.100d0, 2.481759d+19, 5.146847d+11, 5.191560d+18, 4.011660d+16, 8.197200d+15, 5.713200d+08, &
    0.000d0, 1013.00000d0, 257.200d0, 2.852662d+19, 5.144710d+11, 5.966950d+18, 4.011275d+16, 9.421500d+15, 6.566500d+08 /)

    real(8), dimension(50*9), private :: us1976=(/ &
    !# AFGL atmospheric constituent profile. U.S. standard atmosphere 1976. ( AFGL-TR-86-0110)
    !# z(km)      p(mb)       T(K)       air(cm-3)     o3(cm-3)      o2(cm-3)     h2o(cm-3)     co2(cm-3)      no2(cm-3)
    120.000d0,    0.00003d0, 360.000d0, 5.110260d+11, 2.557000d+02, 3.707650d+10, 1.022800d+05, 1.789900d+07, 7.722140d+01, &
    115.000d0,    0.00004d0, 300.000d0, 9.681328d+11, 4.844000d+03, 9.106720d+10, 2.325120d+05, 3.875200d+07, 1.501640d+02, &
    110.000d0,    0.00007d0, 240.000d0, 2.142688d+12, 1.072000d+05, 2.572800d+11, 6.003200d+05, 1.286400d+08, 3.408960d+02, &
    105.000d0,    0.00014d0, 208.800d0, 5.029784d+12, 1.006600d+06, 7.046200d+11, 1.711220d+06, 5.536300d+08, 8.254120d+02, &
    100.000d0,    0.00032d0, 195.100d0, 1.187967d+13, 4.756001d+06, 1.902400d+12, 4.756001d+06, 2.318550d+09, 2.021300d+03, &
     95.000d0,    0.00076d0, 188.400d0, 2.921760d+13, 2.046800d+07, 5.263200d+12, 1.578960d+07, 7.894800d+09, 5.146240d+03, &
     90.000d0,    0.00184d0, 186.900d0, 7.130506d+13, 4.995200d+07, 1.355840d+13, 6.065600d+07, 2.212160d+10, 1.305888d+04, &
     85.000d0,    0.00446d0, 188.900d0, 1.710073d+14, 8.555000d+07, 3.422000d+13, 2.275630d+08, 5.475200d+10, 3.285120d+04, &
     80.000d0,    0.01050d0, 198.600d0, 3.829322d+14, 1.149600d+08, 8.008879d+13, 7.855600d+08, 1.256896d+11, 7.740640d+04, &
     75.000d0,    0.02400d0, 208.400d0, 8.341139d+14, 2.086750d+08, 1.744523d+14, 2.358028d+09, 2.754510d+11, 1.794605d+05, &
     70.000d0,    0.05220d0, 219.600d0, 1.721670d+15, 5.169000d+08, 3.601070d+14, 6.030500d+09, 5.685899d+11, 3.980130d+05, &
     65.000d0,    0.10900d0, 233.300d0, 3.383947d+15, 2.370200d+09, 7.076740d+14, 1.422120d+10, 1.117380d+12, 8.566580d+05, &
     60.000d0,    0.21900d0, 247.000d0, 6.421832d+15, 7.068600d+09, 1.343034d+15, 3.052350d+10, 2.120580d+12, 1.831410d+06, &
     55.000d0,    0.42500d0, 260.800d0, 1.180302d+16, 2.125800d+10, 2.468290d+15, 6.023100d+10, 3.897300d+12, 4.003590d+06, &
     50.000d0,    0.79780d0, 270.700d0, 2.134605d+16, 6.621600d+10, 4.464240d+15, 1.116060d+11, 7.048799d+12, 9.462480d+06, &
     47.500d0,    1.09000d0, 270.600d0, 2.917498d+16, 1.197200d+11, 6.102800d+15, 1.533000d+11, 9.636000d+12, 1.944720d+07, &
     45.000d0,    1.49100d0, 264.200d0, 4.087489d+16, 2.147250d+11, 8.548099d+15, 2.137025d+11, 1.349700d+13, 4.703500d+07, &
     42.500d0,    2.06000d0, 257.300d0, 5.798815d+16, 3.597860d+11, 1.212827d+16, 2.988545d+11, 1.914990d+13, 1.259251d+08, &
     40.000d0,    2.87100d0, 250.400d0, 8.304447d+16, 6.066300d+11, 1.736790d+16, 4.175775d+11, 2.742300d+13, 3.348930d+08, &
     37.500d0,    4.04116d0, 243.435d0, 1.202393d+17, 9.656401d+11, 2.587420d+16, 6.128100d+11, 4.085400d+13, 7.749880d+08, &
     35.000d0,    5.74600d0, 236.500d0, 1.759731d+17, 1.380096d+12, 3.680490d+16, 8.628900d+11, 5.811300d+13, 1.282008d+09, &
     32.500d0,    8.25725d0, 229.588d0, 2.605019d+17, 1.860945d+12, 5.275160d+16, 1.217830d+12, 8.329200d+13, 1.819804d+09, &
     30.000d0,   11.97000d0, 226.500d0, 3.827699d+17, 2.509799d+12, 8.004700d+16, 1.809675d+12, 1.263900d+14, 2.359280d+09, &
     27.500d0,   17.43000d0, 224.000d0, 5.635873d+17, 3.272892d+12, 1.178760d+17, 2.580300d+12, 1.861200d+14, 2.712840d+09, &
     25.000d0,   25.49000d0, 221.600d0, 8.331283d+17, 4.266877d+12, 1.742433d+17, 3.689123d+12, 2.751210d+14, 3.118038d+09, &
     24.000d0,   29.72000d0, 220.600d0, 9.757872d+17, 4.518265d+12, 2.040885d+17, 4.198950d+12, 3.222450d+14, 2.988090d+09, &
     23.000d0,   34.67000d0, 219.600d0, 1.143492d+18, 4.768192d+12, 2.390960d+17, 4.804800d+12, 3.775200d+14, 2.951520d+09, &
     22.000d0,   40.47000d0, 218.600d0, 1.340895d+18, 4.894274d+12, 2.804780d+17, 5.455230d+12, 4.428600d+14, 2.898720d+09, &
     21.000d0,   47.29000d0, 217.600d0, 1.574064d+18, 4.769100d+12, 3.291750d+17, 6.260625d+12, 5.197500d+14, 2.772000d+09, &
     20.000d0,   55.29000d0, 216.700d0, 1.847990d+18, 4.768571d+12, 3.864410d+17, 7.211100d+12, 6.101700d+14, 2.570110d+09, &
     19.000d0,   64.67000d0, 216.700d0, 2.161503d+18, 4.390890d+12, 4.520670d+17, 8.327550d+12, 7.137900d+14, 2.292780d+09, &
     18.000d0,   75.65000d0, 216.700d0, 2.528494d+18, 4.015110d+12, 5.287700d+17, 9.677249d+12, 8.349000d+14, 1.950630d+09, &
     17.000d0,   88.50000d0, 216.700d0, 2.957987d+18, 3.513520d+12, 6.186399d+17, 1.139600d+13, 9.768000d+14, 1.536240d+09, &
     16.000d0,  103.50000d0, 216.700d0, 3.459340d+18, 3.012286d+12, 7.235580d+17, 1.367490d+13, 1.142460d+15, 1.104378d+09, &
     15.000d0,  121.10000d0, 216.700d0, 4.047595d+18, 2.634525d+12, 8.464500d+17, 2.025000d+13, 1.336500d+15, 6.925500d+08, &
     14.000d0,  141.70000d0, 216.700d0, 4.736121d+18, 2.383717d+12, 9.904510d+17, 2.808805d+13, 1.563870d+15, 3.544772d+08, &
     13.000d0,  165.80000d0, 216.700d0, 5.541629d+18, 2.132992d+12, 1.159114d+18, 6.017410d+13, 1.830180d+15, 2.467970d+08, &
     12.000d0,  194.00000d0, 216.700d0, 6.484174d+18, 2.008345d+12, 1.356201d+18, 1.236803d+14, 2.141370d+15, 2.044035d+08, &
     11.000d0,  227.00000d0, 216.800d0, 7.583652d+18, 1.630876d+12, 1.586101d+18, 2.741906d+14, 2.504370d+15, 1.988318d+08, &
     10.000d0,  265.00000d0, 223.300d0, 8.595457d+18, 1.129443d+12, 1.797818d+18, 6.017959d+14, 2.838660d+15, 2.047276d+08, &
      9.000d0,  308.00000d0, 229.700d0, 9.711841d+18, 8.910379d+11, 2.031271d+18, 1.538518d+15, 3.207270d+15, 2.254808d+08, &
      8.000d0,  356.50000d0, 236.200d0, 1.093179d+19, 6.526804d+11, 2.286460d+18, 4.011698d+15, 3.610200d+15, 2.516200d+08, &
      7.000d0,  411.10001d0, 242.700d0, 1.226845d+19, 6.151052d+11, 2.566520d+18, 7.024160d+15, 4.052400d+15, 2.824400d+08, &
      6.000d0,  472.20001d0, 249.200d0, 1.372429d+19, 5.645776d+11, 2.869570d+18, 1.270574d+16, 4.530900d+15, 3.157900d+08, &
      5.000d0,  540.50000d0, 255.700d0, 1.531006d+19, 5.772576d+11, 3.201880d+18, 2.140204d+16, 5.055600d+15, 3.523600d+08, &
      4.000d0,  616.59998d0, 262.200d0, 1.703267d+19, 5.771448d+11, 3.561360d+18, 3.677232d+16, 5.623200d+15, 3.919200d+08, &
      3.000d0,  701.20001d0, 268.700d0, 1.890105d+19, 6.274337d+11, 3.952190d+18, 6.017162d+16, 6.240300d+15, 4.349300d+08, &
      2.000d0,  795.00000d0, 275.200d0, 2.092331d+19, 6.778279d+11, 4.376460d+18, 9.697315d+16, 6.910200d+15, 4.816201d+08, &
      1.000d0,  898.79999d0, 281.700d0, 2.310936d+19, 6.779402d+11, 4.834170d+18, 1.404222d+17, 7.632900d+15, 5.319900d+08, &
      0.000d0, 1013.00000d0, 288.200d0, 2.545818d+19, 6.777680d+11, 5.325320d+18, 1.973426d+17, 8.408400d+15, 5.860400d+08 /)

    contains

      subroutine interpolateToStandardAtmosphere(p,output,atmosphere_type,var_index)
        implicit none

        real(8), dimension(:) :: p
        real(8), dimension(:) :: output
        integer, intent(in) :: atmosphere_type, var_index

        real(8), parameter :: p0 = 1013.25d0
        real(8), parameter :: T0 = 273.15d0
        real(8), parameter :: L0 = 2.6867775d+25
        real(8), parameter :: MW_h2o = 18.01528d0
        real(8), parameter :: MW_air = 28.9648d0
        real(8), parameter :: Na = 6.02214179d+23
        real(8), parameter :: R = 8.314472d0
        real(8), dimension(50) :: p_table, t_table, nd_tot, nd_dry, x, y
        real(8), dimension(9,50) :: work

        integer :: i,j,k,n,z
        real(8) :: A,Rv

        select case(atmosphere_type)
          case(TROPICAL_ATM);            work = reshape(tropicalatm, shape(work))
          case(MID_LAT_SUMMER_ATM);      work = reshape(midlatsum, shape(work))
          case(MID_LAT_WINTER_ATM);      work = reshape(midlatwin, shape(work))
          case(SUB_ARCTIC_SUMMER_ATM);   work = reshape(subarcsum, shape(work))
          case(SUB_ARCTIC_WINTER_ATM);   work = reshape(subarcwin, shape(work))
          case(US_STANDARD_ATM);         work = reshape(us1976, shape(work))
          case default; STOP 'AUX_Standard_Atmosphere: unknown PCS%Climatology [STOP]'
        end select

        p_table = work(P_INDEX,:)
        t_table = work(T_INDEX,:)

        nd_tot = L0 * p_table/p0 * T0/t_table
        nd_dry = nd_tot - work(H2O_INDEX,:)*1.0d+6

        !  z   km         -> not converted
        !  p   mb         -> hPa (semantic)
        !  T   K          -> not converted
        !  air 1/cm**3    -> ppmv
        !  o3  1/cm**3    -> ppmv
        !  o2  1/cm**3    -> ppmv
        !  h2o 1/cm**3    -> g/kg
        !  co2 1/cm**3    -> ppmv
        !  no2 1/cm**3    -> ppmv
        select case(var_index)
            case (Z_INDEX,P_INDEX,T_INDEX); y = work(var_index,:)
            case (AIR_INDEX,O3_INDEX,O2_INDEX,CO2_INDEX,NO2_INDEX); y = work(var_index,:)/nd_dry * 1.0D+12
            case (H2O_INDEX); y = work(var_index,:)/nd_dry * MW_h2o/MW_air * 1.0D+9
        end select

        n = size(y)
        x = work(P_INDEX,:)

        do z=1,size(p)
            A = p(z)
            if ((A < X(2)) .OR. (A > X(n-1))) then
                if (A < X(2))   i = 1
                if (A > X(n-1)) i = n - 1
            else
                j = 2
                k = n - 1
                i = (j + k) / 2
                do while (i /= j)
                  if (A < X(i)) k = i
                  if (A >= X(i)) j = i
                  i = (j + k) / 2
                end do
            end if
            Rv = (A - X(i)) / (X(i+1) - X(i))
            output(z) = Y(i) + Rv * (Y(i+1) - Y(i))
        end do
    end subroutine
end module
